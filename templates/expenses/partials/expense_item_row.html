<div id="expense-item-{{ item.id }}" class="card expense-item-card mb-3 {% if item.requires_receipt and not item.receipt_requirement_met %}needs-receipt{% elif item.requires_receipt %}receipt-ok{% endif %}">
    <div class="card-body">
        <div class="d-flex justify-content-between align-items-start">
            <div class="flex-grow-1">
                <div class="d-flex align-items-center gap-2 mb-1">
                    <span class="badge bg-secondary">{{ item.category.name }}</span>
                    <small class="text-muted">{{ item.date|date:"M j, Y" }}</small>
                    {% if item.requires_receipt %}
                    {% if item.receipt_requirement_met %}
                    <span class="badge bg-success"><i class="bi bi-check"></i> Receipt OK</span>
                    {% else %}
                    <span class="badge bg-warning text-dark"><i class="bi bi-exclamation-triangle"></i> Receipt Required</span>
                    {% endif %}
                    {% endif %}
                </div>
                <h6 class="mb-1">{{ item.description }}</h6>
                {% if item.client %}<small class="text-muted">Client: {{ item.client }}</small>{% endif %}
            </div>
            <div class="text-end">
                <div class="h5 mb-0" style="font-family: var(--font-mono);">${{ item.amount|floatformat:2 }}</div>
                <button type="button" class="btn btn-sm btn-link text-danger p-0 mt-1" onclick="deleteItem({{ item.id }})">
                    <i class="bi bi-trash"></i> Remove
                </button>
            </div>
        </div>

        <!-- Receipts -->
        <div class="mt-3" id="receipts-{{ item.id }}">
            {% include "expenses/partials/receipt_list.html" with item=item report=report %}
        </div>
    </div>
</div>
